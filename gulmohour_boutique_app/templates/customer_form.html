{% extends 'base.html' %}

{% block title %}
{% if customer and customer.id %}Edit Customer{% else %}Add Customer{% endif %}
{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto p-6 bg-white rounded-2xl shadow-lg mt-8">
  <h2 class="text-3xl font-semibold text-rose-600 mb-6">
    {% if customer and customer.id %}Edit Customer: {{ customer.name }}{% else %}Add New Customer{% endif %}
  </h2>

  <form method="POST" class="space-y-6">
    <!-- Contact Details -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div>
        <label class="block text-sm font-medium text-gray-700">Full Name</label>
        <input type="text" name="name" value="{{ customer.name if customer else '' }}" required
               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-rose-500 focus:border-rose-500 sm:text-sm">
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Phone</label>
        <input type="text" name="phone" value="{{ customer.phone if customer else '' }}" required
               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-rose-500 focus:border-rose-500 sm:text-sm">
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Email (Optional)</label>
        <input type="email" name="email" value="{{ customer.email if customer else '' }}"
               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-rose-500 focus:border-rose-500 sm:text-sm">
      </div>
    </div>

    <!-- Address Details -->
    <div class="p-4 border-t border-b border-gray-200">
      <h3 class="text-xl font-semibold text-rose-600 mb-4">Address</h3>
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <input type="text" name="line1" placeholder="Address Line 1"
               value="{{ customer.address.line1 if customer and customer.address else '' }}"
               class="col-span-full mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-rose-500 focus:border-rose-500 sm:text-sm">
        <input type="text" name="city" placeholder="City"
               value="{{ customer.address.city if customer and customer.address else '' }}"
               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-rose-500 focus:border-rose-500 sm:text-sm">
        <input type="text" name="state" placeholder="State/Province"
               value="{{ customer.address.state if customer and customer.address else '' }}"
               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-rose-500 focus:border-rose-500 sm:text-sm">
        <input type="text" name="pin" placeholder="PIN/Zip"
               value="{{ customer.address.pin if customer and customer.address else '' }}"
               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-rose-500 focus:border-rose-500 sm:text-sm">
        <input type="text" name="country" placeholder="Country"
               value="{{ customer.address.country if customer and customer.address else '' }}"
               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-rose-500 focus:border-rose-500 sm:text-sm">
      </div>
    </div>

    <!-- Measurements Section -->
    <div class="p-4 border-t border-b border-gray-200 grid grid-cols-1 lg:grid-cols-2 gap-6">
      <h3 class="text-xl font-semibold text-rose-600 lg:col-span-2 mb-2">Standard Measurements (Inches)</h3>

      {% set customer_measurements = customer.measurements | default({}) %}
      {% set top_data = customer_measurements.get('top', {}) %}
      {% set bottom_data = customer_measurements.get('bottom', {}) %}

      <!-- Top Measurements -->
      <div>
        <h4 class="font-medium text-gray-700 mb-2">Top / Blouse / Kurti</h4>
        <div class="grid grid-cols-2 gap-4">
          {% set top_fields = ['shoulder','bust','waist','hip','armhole','sleeve_length','top_length','neck','front_neck','back_neck'] %}
          {% for field in top_fields %}
            <div>
              <label class="block text-sm text-gray-600">{{ field.replace('_',' ').title() }}</label>
              <input type="text" name="{{ field }}" value="{{ top_data.get(field, '') }}"
                     class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-rose-500 focus:border-rose-500 sm:text-sm">
            </div>
          {% endfor %}
        </div>
      </div>

      <!-- Bottom Measurements -->
      <div>
        <h4 class="font-medium text-gray-700 mb-2">Bottom / Salwar / Trousers (use '_b' suffix in name)</h4>
        <div class="grid grid-cols-2 gap-4">
          {% set bottom_fields = ['waist_b','hip_b','thigh','knee','calf','ankle','bottom_length'] %}\n
          {% for field in bottom_fields %}
            <div>
              <label class="block text-sm text-gray-600">{{ field.replace('_',' ').title() }}</label>
              <input type="text" name="{{ field }}" value="{{ bottom_data.get(field, '') }}"
                     class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-rose-500 focus:border-rose-500 sm:text-sm">
            </div>
          {% endfor %}
        </div>
      </div>
    </div>

    <div class="mt-6">
      <button type="submit" class="w-full md:w-auto px-6 py-3 bg-rose-600 text-white rounded-lg hover:bg-rose-700 transition font-medium shadow-md">
        {% if customer and customer.id %}Save Changes{% else %}Add Customer{% endif %}
      </button>
    </div>

  </form>
</div>
{% endblock %}
