{% extends 'base.html' %}

{% block title %}{% if customer and customer.id %}Edit Customer{% else %}Add Customer{% endif %} - Gulmohour{% endblock %}
{% block page_title %}{% if customer and customer.id %}Edit Customer{% else %}Add New Customer{% endif %}{% endblock %}
  {% block page_subtitle %}
  {% if customer and customer.id %}
    Update customer information
  {% else %}
    Create a new customer profile
  {% endif %}
{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto">
  <div class="glass-effect rounded-2xl p-6 lg:p-8 shadow-lg">
    
    <form method="POST" class="space-y-8">
      
      <!-- Contact Details Section -->
      <div>
        <div class="flex items-center space-x-3 mb-6">
          <div class="p-2 bg-gradient-to-br from-primary-500 to-primary-600 rounded-lg">
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
            </svg>
          </div>
          <h3 class="text-xl font-display font-bold text-gray-900">Contact Information</h3>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Full Name *</label>
            <input type="text" name="name" value="{{ customer.name if customer else '' }}" required
                   class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition">
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Phone Number *</label>
            <input type="text" name="phone" value="{{ customer.phone if customer else '' }}" required
                   class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition">
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">Email (Optional)</label>
            <input type="email" name="email" value="{{ customer.email if customer else '' }}"
                   class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition">
          </div>
        </div>
      </div>

      <!-- Address Section -->
      <div class="pt-6 border-t border-gray-200">
        <div class="flex items-center space-x-3 mb-6">
          <div class="p-2 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg">
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
            </svg>
          </div>
          <h3 class="text-xl font-display font-bold text-gray-900">Address</h3>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          <div class="md:col-span-2 lg:col-span-4">
            <label class="block text-sm font-semibold text-gray-700 mb-2">House/Flat No.</label>
            <input type="text" name="house" placeholder="e.g., Flat 301, Building A"
                   value="{{ customer.address.house if customer and customer.address else '' }}"
                   class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition">
          </div>
          <div class="md:col-span-2 lg:col-span-4">
            <label class="block text-sm font-semibold text-gray-700 mb-2">Locality/Street</label>
            <input type="text" name="locality" placeholder="e.g., MG Road, Sector 5"
                   value="{{ customer.address.locality if customer and customer.address else '' }}"
                   class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition">
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">City</label>
            <input type="text" name="city" placeholder="e.g., Mumbai"
                   value="{{ customer.address.city if customer and customer.address else '' }}"
                   class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition">
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">State</label>
            <input type="text" name="state" placeholder="e.g., Maharashtra"
                   value="{{ customer.address.state if customer and customer.address else '' }}"
                   class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition">
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">PIN Code</label>
            <input type="text" name="pin" placeholder="e.g., 400001"
                   value="{{ customer.address.pin if customer and customer.address else '' }}"
                   class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition">
          </div>
        </div>
      </div>

      <!-- Measurements Section -->
      <div class="pt-6 border-t border-gray-200">
        <div class="flex items-center space-x-3 mb-6">
          <div class="p-2 bg-gradient-to-br from-accent-400 to-accent-500 rounded-lg">
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"/>
            </svg>
          </div>
          <h3 class="text-xl font-display font-bold text-gray-900">Standard Measurements (inches)</h3>
        </div>

        {% set customer_measurements = customer.measurements | default({}) %}

        <div class="bg-gradient-to-br from-primary-50 to-pink-50 p-6 rounded-xl border border-primary-100 mb-6">
          <h4 class="font-semibold text-gray-800 mb-4 text-lg">Main Garment Measurements</h4>
          <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Length</label>
              <input type="text" name="length" value="{{ customer_measurements.get('length', '') }}" placeholder="e.g., 38"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm">
            </div>
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Shoulder</label>
              <input type="text" name="shoulder" value="{{ customer_measurements.get('shoulder', '') }}" placeholder="e.g., 14"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm">
            </div>
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Armhole</label>
              <input type="text" name="armhole" value="{{ customer_measurements.get('armhole', '') }}" placeholder="e.g., 16"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm">
            </div>
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Upper Chest</label>
              <input type="text" name="upper_chest" value="{{ customer_measurements.get('upper_chest', '') }}" placeholder="e.g., 36"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm">
            </div>
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Chest</label>
              <input type="text" name="chest" value="{{ customer_measurements.get('chest', '') }}" placeholder="e.g., 38"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm">
            </div>
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Waist</label>
              <input type="text" name="waist" value="{{ customer_measurements.get('waist', '') }}" placeholder="e.g., 32"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm">
            </div>
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Stomach</label>
              <input type="text" name="stomach" value="{{ customer_measurements.get('stomach', '') }}" placeholder="e.g., 34"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm">
            </div>
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Hips</label>
              <input type="text" name="hips" value="{{ customer_measurements.get('hips', '') }}" placeholder="e.g., 40"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm">
            </div>
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Front/Back Cross</label>
              <input type="text" name="front_back_cross" value="{{ customer_measurements.get('front_back_cross', '') }}" placeholder="e.g., 14"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm">
            </div>
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Sleeve Length</label>
              <input type="text" name="sleeve_length" value="{{ customer_measurements.get('sleeve_length', '') }}" placeholder="e.g., 18"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm">
            </div>
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Neck (Front & Back)</label>
              <input type="text" name="neck_front_back" value="{{ customer_measurements.get('neck_front_back', '') }}" placeholder="e.g., 8/6"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm">
            </div>
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Dart Point</label>
              <input type="text" name="dart_point" value="{{ customer_measurements.get('dart_point', '') }}" placeholder="e.g., 10"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 text-sm">
            </div>
          </div>
        </div>

        <!-- Pants Measurements -->
        <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-100">
          <h4 class="font-semibold text-gray-800 mb-4 text-lg">Pants Measurements</h4>
          <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
            {% set pants = customer_measurements.get('pants', {}) %}
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Length</label>
              <input type="text" name="pants_length" value="{{ pants.get('length', '') }}" placeholder="e.g., 40"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
            </div>
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Waist</label>
              <input type="text" name="pants_waist" value="{{ pants.get('waist', '') }}" placeholder="e.g., 30"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
            </div>
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Thigh</label>
              <input type="text" name="pants_thigh" value="{{ pants.get('thigh', '') }}" placeholder="e.g., 24"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
            </div>
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Mori</label>
              <input type="text" name="pants_mori" value="{{ pants.get('mori', '') }}" placeholder="e.g., 18"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
            </div>
            <div>
              <label class="block text-xs font-medium text-gray-600 mb-1">Calf</label>
              <input type="text" name="pants_calf" value="{{ pants.get('calf', '') }}" placeholder="e.g., 14"
                     class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
            </div>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex flex-col sm:flex-row justify-end gap-4 pt-6 border-t border-gray-200">
        <a href="{{ url_for('customers') if not customer else url_for('view_customer', customer_id=customer.id) }}"
           class="px-6 py-3 bg-white border-2 border-gray-200 text-gray-700 rounded-xl hover:bg-gray-50 transition font-medium text-center">
          Cancel
        </a>
        <button type="submit"
                class="px-6 py-3 bg-gradient-to-r from-primary-500 to-primary-600 text-white rounded-xl hover:shadow-lg hover:shadow-primary-500/30 transition font-semibold">
          {% if customer and customer.id %}Save Changes{% else %}Add Customer{% endif %}
        </button>
      </div>
    </form>
  </div>
</div>
{% endblock %}