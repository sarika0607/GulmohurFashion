{% extends "base.html" %}

{% block title %}Edit Order - {{ order.customer_name }}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto p-6 bg-white shadow rounded-lg mt-6">

  <!-- Breadcrumb -->
  <nav class="text-gray-500 text-sm mb-6">
    <a href="{{ url_for('dashboard') }}" class="hover:text-rose-600">Dashboard</a> &raquo;
    <a href="{{ url_for('view_customer', customer_id=order.customer_id) }}" class="hover:text-rose-600">{{ order.customer_name }}</a> &raquo;
    Edit Order
  </nav>

  <h2 class="text-3xl font-bold text-rose-600 mb-6">Edit Order</h2>

  <form method="POST" class="space-y-6">

    <!-- Dress Details -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="block text-gray-700 font-medium mb-2">Dress Type</label>
        <input type="text" name="dress_type" value="{{ order.dress_type }}"
               class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-rose-300" required>
      </div>

      <div>
        <label class="block text-gray-700 font-medium mb-2">Occasion</label>
        <input type="text" name="occasion" value="{{ order.occasion }}"
               class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-rose-300">
      </div>

      <div>
        <label class="block text-gray-700 font-medium mb-2">Fabric</label>
        <input type="text" name="fabric" value="{{ order.fabric }}"
               class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-rose-300">
      </div>

      <div>
        <label class="block text-gray-700 font-medium mb-2">Delivery Date</label>
        <input type="date" name="delivery_date" value="{{ order.delivery_date }}"
               class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-rose-300">
      </div>
    </div>

    <!-- Design Notes -->
    <div>
      <label class="block text-gray-700 font-medium mb-2">Design Notes</label>
      <textarea name="design_notes" rows="4"
                class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-rose-300">{{ order.design_notes }}</textarea>
    </div>

    <!-- Reference Links -->
    <div>
      <label class="block text-gray-700 font-medium mb-2">Reference Links</label>
      <div id="reference-links-container" class="space-y-2">
        {% if order.reference_links %}
          {% for link in order.reference_links %}
          <input type="text" name="reference_links" value="{{ link }}" placeholder="Reference link"
                 class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-rose-300">
          {% endfor %}
        {% else %}
          <input type="text" name="reference_links" placeholder="Reference link"
                 class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-rose-300">
        {% endif %}
      </div>
      <button type="button" id="add-link-btn"
              class="mt-2 px-3 py-1 bg-rose-100 text-rose-700 rounded hover:bg-rose-200 transition text-sm">
        + Add another link
      </button>
    </div>

    <!-- Status -->
    <div>
      <label class="block text-gray-700 font-medium mb-2">Status</label>
      <select name="status" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-rose-300">
        <option value="Pending" {% if order.status == 'Pending' %}selected{% endif %}>Pending</option>
        <option value="In Progress" {% if order.status == 'In Progress' %}selected{% endif %}>In Progress</option>
        <option value="Delivered" {% if order.status == 'Delivered' %}selected{% endif %}>Delivered</option>
      </select>
    </div>

    <!-- Buttons -->
    <div class="flex justify-end mt-6 space-x-4">
      <a href="{{ url_for('view_customer', customer_id=order.customer_id) }}"
         class="px-6 py-2 bg-gray-300 text-gray-800 rounded hover:bg-gray-400 transition">
        Cancel
      </a>
      <button type="submit" class="px-6 py-2 bg-rose-600 text-white rounded hover:bg-rose-700 transition">
        Save Changes
      </button>
    </div>

  </form>
</div>

<!-- JS to add new reference link dynamically -->
<script>
  document.getElementById('add-link-btn').addEventListener('click', function() {
    const container = document.getElementById('reference-links-container');
    const input = document.createElement('input');
    input.type = 'text';
    input.name = 'reference_links';
    input.placeholder = 'Reference link';
    input.className = 'w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-rose-300';
    container.appendChild(input);
  });
</script>

{% endblock %}
